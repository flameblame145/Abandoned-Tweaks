<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<img src="image.png" alt="My Logo" style="height: 100px;">

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBM2hoB6SsSKywsbJoYkd8CWG1I46raBTY",
    authDomain: "abandonedtweaks-b47a2.firebaseapp.com",
    projectId: "abandonedtweaks-b47a2",
    storageBucket: "abandonedtweaks-b47a2.appspot.com",
    messagingSenderId: "26177710755",
    appId: "1:26177710755:web:c804d0eef4be276a7c2d16",
    measurementId: "G-6H06DVYMCV"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  auth.onAuthStateChanged(user => {
    const btn = document.getElementById('auth-btn');
    if (user) {
      btn.textContent = 'Logout';
      btn.onclick = () => auth.signOut().then(() => window.location.reload());
    } else {
      btn.textContent = 'Login / Signup';
      btn.onclick = () => window.location.href = 'login.html';
    }
  });

  function generateRandomCode(length = 12) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    let result = '';
    for (let i = 0; i < length; i++) {
      result += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return result;
  }

  async function enterDiscountCode() {
    const user = auth.currentUser;
    if (!user) {
      alert('You must be logged in to enter a discount code.');
      return;
    }

    const code = prompt('Enter your discount code:');
    if (!code) return;

    if (code !== 'TikTok15') {
      alert('Invalid discount code.');
      return;
    }

    const usedRef = db.collection('discountCodesUsed').doc(user.uid);
    const doc = await usedRef.get();

    if (doc.exists) {
      alert('You have already used this discount code once.');
      return;
    }

    const randomCode = generateRandomCode();
    const timestamp = new Date();

    await usedRef.set({
      codeUsed: code,
      randomCode,
      usedAt: timestamp.toISOString()
    });

    alert(`Success! Your unique code is: ${randomCode}\nUsed on: ${timestamp.toLocaleString()}`);
  }

  window.addEventListener('DOMContentLoaded', () => {
    document.getElementById('discountBtn').addEventListener('click', enterDiscountCode);
  });
</script>

<style>
/* General site styling (already included in your file, shortened here for brevity) */

/* Rainbow purchase button style */
.rainbow-button {
  padding: 20px 40px;
  font-size: 1.4rem;
  font-weight: bold;
  color: #fff;
  background: linear-gradient(270deg, red, orange, yellow, green, blue, indigo, violet);
  background-size: 400% 400%;
  border: none;
  border-radius: 16px;
  cursor: pointer;
  animation: rainbow 6s linear infinite;
  box-shadow: 0 0 12px rgba(255,255,255,0.4);
  transition: box-shadow 0.3s;
}
.rainbow-button:hover {
  box-shadow: 0 0 24px rgba(255,255,255,0.6);
}

@keyframes rainbow {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Add your other existing CSS here (purchase buttons, product-card, etc.) */
</style>
</head>
<body>
<button id="auth-btn">Loading...</button>

<div class="container">
  <div class="products">

    <!-- 0 Delay product card -->
    <div class="product-card">
      <h3>0 Delay</h3>
      <div class="price">$4.99</div>
      <div class="rating">â˜…â˜…â˜…â˜…â˜… (9)</div>
      <div class="description">Experience zero input delay for faster building, smoother edits, and better gameplay in Fortnite.</div>
      <div class="product-video">
        <iframe src="https://www.youtube.com/embed/G2igjYONmzw" frameborder="0" allowfullscreen></iframe>
      </div>
      <div class="purchase-buttons">
        <button class="rainbow-button" onclick="window.location.href='https://abandonedtweaks.mysellauth.com/product/0-delay'">ðŸ›’ Purchase ðŸ›’</button>
      </div>
    </div>

  </div>
</div>

</body>
</html>
