<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Abandoned Tweaks</title>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBM2hoB6SsSKywsbJoYkd8CWG1I46raBTY",
      authDomain: "abandonedtweaks-b47a2.firebaseapp.com",
      projectId: "abandonedtweaks-b47a2",
      storageBucket: "abandonedtweaks-b47a2.firebasestorage.app",
      messagingSenderId: "26177710755",
      appId: "1:26177710755:web:c804d0eef4be276a7c2d16",
      measurementId: "G-6H06DVYMCV"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Handle auth button
    auth.onAuthStateChanged(user => {
      const btn = document.getElementById('auth-btn');
      if (user) {
        btn.textContent = 'Logout';
        btn.onclick = () => auth.signOut().then(() => window.location.reload());
      } else {
        btn.textContent = 'Login / Signup';
        btn.onclick = () => window.location.href = 'login.html'; // Adjust if you have a login page
      }
    });

    // Generate random code helper
    function generateRandomCode(length = 12) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let result = '';
      for (let i = 0; i < length; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return result;
    }

    // Show a panel overlay
    function showPanel(contentHtml) {
      const existingPanel = document.getElementById('discountPanel');
      if (existingPanel) existingPanel.remove();

      const panel = document.createElement('div');
      panel.id = 'discountPanel';
      panel.innerHTML = `
        <div class="panel-content">
          <button id="closePanelBtn" aria-label="Close panel">&times;</button>
          <div class="panel-body">${contentHtml}</div>
        </div>
      `;
      document.body.appendChild(panel);

      document.getElementById('closePanelBtn').onclick = () => {
        panel.remove();
      };
    }

    async function enterDiscountCode() {
      const user = auth.currentUser;
      if (!user) {
        alert('You must be logged in to enter a discount code.');
        return;
      }

      // Prompt user for code
      const code = prompt('Enter your discount code:');
      if (!code) return;

      if (code !== 'TikTok15') {
        alert('Invalid discount code.');
        return;
      }

      const usedRef = db.collection('discountCodesUsed').doc(user.uid);
      const doc = await usedRef.get();

      if (doc.exists) {
        // User already used code - show previous code and date
        const data = doc.data();
        const usedAt = new Date(data.usedAt);
        showPanel(`
          <h2>Discount Code Already Used</h2>
          <p><strong>Original Discount Code:</strong> TikTok15</p>
          <p><strong>Your Unique Order Number:</strong> ${data.randomCode}</p>
          <p><strong>Used on:</strong> ${usedAt.toLocaleString()}</p>
        `);
        return;
      }

      // New use - generate random code and save with timestamp
      const randomCode = generateRandomCode();
      const timestamp = new Date();

      await usedRef.set({
        codeUsed: code,
        randomCode,
        usedAt: timestamp.toISOString()
      });

      showPanel(`
        <h2>Discount Applied Successfully!</h2>
        <p><strong>Discount Code:</strong> TikTok15</p>
        <p><strong>Your Unique Order Number:</strong> ${randomCode}</p>
        <p><strong>Used on:</strong> ${timestamp.toLocaleString()}</p>
      `);
    }

    window.addEventListener('DOMContentLoaded', () => {
      document.getElementById('discountBtn').addEventListener('click', enterDiscountCode);
    });
  </script>

  <style>
    /* Existing styles omitted for brevity - keep all your styles as is */

    /* Discount button style */
    #discountBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 1rem 1.5rem;
      font-size: 1rem;
      font-weight: bold;
      background: #00ffff;
      border: none;
      border-radius: 8px;
      color: #111;
      cursor: pointer;
      box-shadow: 0 0 10px #00ffff;
      transition: box-shadow 0.3s;
      z-index: 1000;
    }
    #discountBtn:hover {
      box-shadow: 0 0 20px #00ffff;
    }

    /* Panel overlay */
    #discountPanel {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 255, 255, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1100;
      backdrop-filter: blur(6px);
    }
    #discountPanel .panel-content {
      background: #111;
      border: 2px solid #00ffff;
      border-radius: 12px;
      box-shadow: 0 0 30px #00ffff;
      width: 320px;
      max-width: 90%;
      padding: 1.5rem 2rem 2rem 2rem;
      color: #0ff;
      position: relative;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    #discountPanel #closePanelBtn {
      position: absolute;
      top: 8px;
      right: 12px;
      background: transparent;
      border: none;
      color: #0ff;
      font-size: 1.8rem;
      font-weight: bold;
      cursor: pointer;
      line-height: 1;
      padding: 0;
      user-select: none;
      transition: color 0.2s;
    }
    #discountPanel #closePanelBtn:hover {
      color: #fff;
    }
    #discountPanel .panel-body p {
      margin: 0.7rem 0;
      font-size: 1rem;
      line-height: 1.3;
    }
    #discountPanel h2 {
      margin-top: 0;
      margin-bottom: 1rem;
      font-weight: bold;
      font-size: 1.4rem;
      color: #00ffff;
      text-shadow:
        0 0 8px #00ffff,
        0 0 20px #00ffff;
    }
  </style>
</head>
<body>
  <button id="auth-btn">Loading...</button>
  <div class="starry-background" id="stars"></div>

  <header>
    <h1 class="title">Abandoned Tweaks</h1>
  </header>
  <nav>
    <a href="https://discord.gg/qyZEhex3HJ" target="_blank">Discord</a>
    <a href="#">Purchase</a>
    <a href="https://www.tiktok.com/@abandonedtweaks" target="_blank">TikTok</a>
  </nav>

  <div class="container">
    <div class="products">

      <!-- All your product cards below, unchanged -->

      <!-- Variety Pack -->
      <div class="product-card">
        <h3 class="rainbow-text">Variety Pack</h3>
        <div class="price">$49.99</div>
        <div class="rating">★★★★★ (14)</div>
        <div class="description">All of the packs — even ones unreleased.</div>
        <div class="product-video">
          <iframe src="https://www.youtube.com/embed/bye_iNOUFEY" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/49.99" class="purchase-button paypal" target="_blank" rel="noopener noreferrer">PayPal</a>
          <a href="https://cash.app/$trazeymax/49.99" class="purchase-button cashapp" target="_blank" rel="noopener noreferrer">CashApp</a>
        </div>
      </div>

      <!-- Taste Tester -->
      <div class="product-card">
        <h3 class="neon-text">Taste Tester</h3>
        <div class="price">$19.99</div>
        <div class="rating">★★★★★ (19)</div>
        <div class="description">Massively improves aim, builds, and performance.</div>
        <div class="product-video">
          <iframe src="https://www.youtube.com/embed/1LcI4dj9k4w" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/19.99" class="purchase-button paypal" target="_blank" rel="noopener noreferrer">PayPal</a>
          <a href="https://cash.app/$trazeymax/19.99" class="purchase-button cashapp" target="_blank" rel="noopener noreferrer">CashApp</a>
        </div>
      </div>

      <!-- Shotgun Pack V1 -->
      <div class="product-card">
        <h3>Shotgun Pack V1</h3>
        <div class="price">$5.99</div>
        <div class="rating">★★★★★ (7)</div>
        <div class="description">Hit Harder Pumps Most Of The Time, Increase Average Pump Damage, 185 most people. DIAMOND PACK</div>
        <div class="product-video">
          <iframe src="https://www.youtube.com/embed/gD5y8SvbVTA" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/5.99" class="purchase-button paypal" target="_blank" rel="noopener noreferrer">PayPal</a>
          <a href="https://cash.app/$trazeymax/5.99" class="purchase-button cashapp" target="_blank" rel="noopener noreferrer">CashApp</a>
        </div>
      </div>

      <!-- Shotgun Pack V2 -->
      <div class="product-card">
        <h3>Shotgun Pack V2</h3>
        <div class="price">$14.99</div>
        <div class="rating">★★★★★ (8)</div>
        <div class="description">Hit Harder Pumps, Increase Average Pump Damage, 185 everyone. ESSENTIAL PACK</div>
        <div class="product-video">
          <iframe src="https://www.youtube.com/embed/7eDtKVOwSyE" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/14.99" class="purchase-button paypal" target="_blank" rel="noopener noreferrer">PayPal</a>
          <a href="https://cash.app/$trazeymax/14.99" class="purchase-button cashapp" target="_blank" rel="noopener noreferrer">CashApp</a>
        </div>
      </div>

      <!-- Bloom Pack V1 -->
      <div class="product-card">
        <h3>Bloom Pack V1</h3>
        <div class="price">$5.99</div>
        <div class="rating">★★★★★ (14)</div>
        <div class="description">Reduce Bloom, Win Most Bloom Battles Constantly, AR Like a Laser Beam, Hit Most Shots!</div>
        <div class="product-video">
          <iframe src="https://www.youtube.com/embed/9dpDf0SKI0I" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/5.99" class="purchase-button paypal" target="_blank" rel="noopener noreferrer">PayPal</a>
          <a href="https://cash.app/$trazeymax/5.99" class="purchase-button cashapp" target="_blank" rel="noopener noreferrer">CashApp</a>
        </div>
      </div>

      <!-- Bloom Pack V2 -->
      <div class="product-card">
        <h3>Bloom Pack V2</h3>
        <div class="price">$9.99</div>
        <div class="rating">★★★★★ (10)</div>
        <div class="description">Max Bloom Reduction, AR & SMG like lasers, Dominate every fight.</div>
        <div class="product-video">
          <iframe src="https://www.youtube.com/embed/JjFTOm2E7eA" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/9.99" class="purchase-button paypal" target="_blank" rel="noopener noreferrer">PayPal</a>
          <a href="https://cash.app/$trazeymax/9.99" class="purchase-button cashapp" target="_blank" rel="noopener noreferrer">CashApp</a>
        </div>
      </div>

      <!-- WiFi Tweaks -->
      <div class="product-card">
        <h3>WiFi Tweaks</h3>
        <div class="price">$7.99</div>
        <div class="rating">★★★★★ (20)</div>
        <div class="description">Improve network latency and reduce ping spikes for smoother gameplay.</div>
        <div class="product-video">
          <iframe src="https://www.youtube.com/embed/WvOeNU7w2U4" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/7.99" class="purchase-button paypal" target="_blank" rel="noopener noreferrer">PayPal</a>
          <a href="https://cash.app/$trazeymax/7.99" class="purchase-button cashapp" target="_blank" rel="noopener noreferrer">CashApp</a>
        </div>
      </div>

      <!-- SMG Bloom Reducer -->
      <div class="product-card">
        <h3>SMG Bloom Reducer</h3>
        <div class="price">$9.99</div>
        <div class="description">Reduces bloom specifically for SMGs to improve your accuracy and fire rate.</div>
        <div class="product-video">
          <iframe src="https://www.youtube.com/embed/08tGTefwgtM" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/9.99" class="purchase-button paypal" target="_blank" rel="noopener noreferrer">PayPal</a>
          <a href="https://cash.app/$trazeymax/9.99" class="purchase-button cashapp" target="_blank" rel="noopener noreferrer">CashApp</a>
        </div>
      </div>

      <!-- Keyboard Tweaks -->
      <div class="product-card">
        <h3>Keyboard Tweaks</h3>
        <div class="price">$1.99</div>
        <div class="rating">★★★★★ (19)</div>
        <div class="description">Speed up your keystrokes—perfect for faster building & better response. ESSENTIAL PACK</div>
        <div class="product-video"><iframe src="https://www.youtube.com/embed/VOxXStoaLx8" frameborder="0" allowfullscreen></iframe></div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/1.99" class="purchase-button paypal" target="_blank">PayPal</a>
          <a href="https://cash.app/$trazeymax/1.99" class="purchase-button cashapp" target="_blank">CashApp</a>
        </div>
      </div>

      <!-- Mouse Tweaks -->
      <div class="product-card">
        <h3>Mouse Tweaks</h3>
        <div class="price">$1.99</div>
        <div class="rating">★★★★★ (23)</div>
        <div class="description">Makes you click faster & improves timing—great for boosting CPS and smoother edits. DIAMOND PACK</div>
        <div class="product-video"><iframe src="https://www.youtube.com/embed/lm4JylRfC6I" frameborder="0" allowfullscreen></iframe></div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/1.99" class="purchase-button paypal" target="_blank">PayPal</a>
          <a href="https://cash.app/$trazeymax/1.99" class="purchase-button cashapp" target="_blank">CashApp</a>
        </div>
      </div>

      <div class="product-card">
        <h3>Max FPS Tweaks</h3>
        <div class="price">$3.99</div>
        <div class="rating">★★★★★ (20)</div>
        <div class="description">Increase max FPS on most PC builds. ESSENTIAL PACK</div>
        <div class="product-video"><iframe src="https://www.youtube.com/embed/mR7CJ8SX7zg" frameborder="0" allowfullscreen></iframe></div>
        <div class="purchase-buttons">
          <a href="https://paypal.me/paymepaypalplease/3.99" class="purchase-button paypal" target="_blank">PayPal</a>
          <a href="https://cash.app/$trazeymax/3.99" class="purchase-button cashapp" target="_blank">CashApp</a>
        </div>
      </div>

    </div>
  </div>

  <button id="discountBtn" aria-label="Enter discount code">Enter Discount Code</button>

  <footer>
    &copy; 2025 Abandoned Tweaks. All rights reserved.
  </footer>

  <script>
    // Your starry background and shooting stars code (if any) goes here unchanged
  </script>
</body>
</html>
